### UI Proposal (Graphical, Mouse-First) — 2025-11-16

This proposal distills the design documents into a concrete, clickable UI for the top-down, tile-based automation and tower-defense MVP. It aligns with:
- Central current-Z-level tile view
- Resource HUD (stone, iron), waves, core HP
- Right management panel (drones, tasks)
- Bottom console for text→DSL tasks
- Mouse-driven area selection and placement (mine, build warrior)

No features from Missing.md are used.


### 1) Core Screen Layout

High-level layout emphasizing clarity and minimal friction. The entire UI is navigable by mouse; keyboard shortcuts mirror the same actions.

```
┌──────────────────────────────────────────────────────────────────────────────┐
│ TOP HUD: Stone • Iron • Wave Timer • Core HP • [Z▲][Z▼] • [Pause]            │
├───────────────────────────────────────────────────────────────┬──────────────┤
│                                                               │              │
│  CENTER: Current Z-level tile map                             │  RIGHT PANEL │
│  - Pan (MMB/WASD), Zoom (Wheel)                               │  - Drones    │
│  - Hover: tile coords/type                                    │  - Tasks     │
│  - Selection overlays                                         │              │
│                                                               │              │
├───────────────────────────────────────────────────────────────┴──────────────┤
│ BOTTOM CONSOLE:  [  Describe task… ] (Submit)  • Log stream                   │
└──────────────────────────────────────────────────────────────────────────────┘

On-map tool strip (top-left of the map):
[Select] [Mine Area] [Build Warrior] [Cancel]
```


### 2) Panels & Elements

- Top HUD (always visible)
  - Stone, Iron counters
  - Wave status: “Wave N in mm:ss” or “Wave N active”
  - Core HP: “Core 100/100”
  - Z-level controls: clickable [Z▲] [Z▼]
  - Pause button

- Right Panel (bevy_egui)
  - Section: Drones
    - Rows like “Drone #1 — Working: Mine (10,5,0)-(15,7,0)”
    - Click row → center camera on drone; highlight path/area
  - Section: Tasks
    - Rows like “Task #3 — Mine area … — 80%”
    - Click row → highlight task area; scroll drone list to assigned drone
  - Sections are collapsible; vertical scroll if overflowed

- Bottom Console
  - Text input field with Submit button
  - Output log (newest at bottom): confirmations, info, warnings
  - Example: “> mine all iron in this area” → “OK: Created task #3 (mine_box)”

- On-Map Tool Strip (mouse-first entry points)
  - Select (default)
  - Mine Area (same as keyboard M)
  - Build Warrior (same as keyboard W)
  - Cancel (same as ESC; exits current mode)


### 3) Mouse & Keyboard Interactions

- Mouse (primary)
  - Left click: select tile/entity; confirm placement in build mode
  - Left drag: draw selection rectangle (when a mode expects an area)
  - Right click: cancel current interaction (kept simple for MVP)
  - Middle button drag or WASD: pan camera
  - Scroll wheel: zoom
  - Hover: show tile coordinates and tile kind near cursor

- Keyboard (mirrors UI; optional)
  - M: Mine Area mode
  - W: Build Warrior mode
  - < / > or PageUp / PageDown: Z-level up/down
  - Space: Pause/Unpause
  - Enter: focus console
  - ESC: Cancel/exit current mode


### 4) Modes & Click Flows

- Select Mode (default)
  - Click tile/entity to inspect; highlight selection
  - Right panel reflects current selection (drone or task row auto-focused)

- Mine Area Mode (via tool strip or M)
  - Step 1: Left-drag rectangle on map (area overlay appears while dragging)
  - Step 2: Bottom console auto-focuses with “Describe what to do with this area:”
  - Step 3: User types NL (e.g., “mine all iron in this area”) → Submit
  - System: Create task (JSON AST), assign to idle drone
  - Feedback: Drone status “Thinking → Working → Finished”; task row updates with progress

- Build Warrior Mode (via tool strip or W)
  - Allowed targets: tiles marked WarriorSpot
  - Step 1: Hover a WarriorSpot → show “Place (cost: 10 iron)” tooltip
  - Step 2: Left-click to place; if iron >= cost → spawn warrior, deduct iron
  - If insufficient iron: show toast in HUD and log line in console
  - Edge cases: occupied spot → tooltip “Occupied” and no placement

- Cancel (via tool strip or ESC / Right-click)
  - Clears pending rectangle/placement and returns to Select


### 5) Visual Feedback

- Selection overlays
  - Tiles under cursor: subtle highlight
  - Drag-area: semi-transparent rectangle with border
  - Selected entity: outline/glow; camera jump on list clicks

- Status surfacing
  - Drones in-map: small status pip (Idle/Thinking/Working/Finished)
  - Task progress: percent in right panel, optional faint progress bar
  - Wave timer and Core HP in top HUD

- Errors & confirmations
  - Toasts near top HUD (short, auto-dismiss)
  - Persistent lines in console log


### 6) Z-Level Controls

- Visible, clickable arrows [Z▲] [Z▼] in the top HUD
- Current Z-level readout (e.g., “Z: 0”)
- Keyboard shortcuts remain active for power users


### 7) States & Screens

- Gameplay (default)
- Pause overlay (Space or Pause button)
  - Buttons: Resume, Settings (basic), Quit to menu (optional later)
- Game Over overlay
  - Message: Core destroyed
  - Buttons: Retry (regenerate world), Quit


### 8) Implementation Notes (MVP-friendly)

- Tech fit
  - Render: top-down 2D; draw only tiles where tile.z == CurrentLayer
  - UI: bevy_egui for HUD, right panel, console, and tool strip

- Structure
  - Center view is the game world; UI overlays/panels must not block panning/zooming inside the map region
  - Focus management: when Mine Area completes dragging, auto-focus the console input

- Performance
  - Lazy redraws for right panel lists
  - Simple icons/rects for entities and tiles in MVP


### 9) Consistency With Design Docs

- Matches MVP: central tile view; resources; waves; core HP; worker drones; warrior placement on WarriorSpot; JSON AST tasks; statuses; right panel lists; bottom console
- Mouse-first parity with keys: Mine Area, Build Warrior, Cancel, Z-level control, Pause
- Right click kept as Cancel for MVP (context menus reserved for later)


### 10) Quick Acceptance Checklist

- Top HUD shows Stone, Iron, Wave timer, Core HP, Z-level with clickable arrows, Pause button
- Right panel lists Drones and Tasks; items are clickable to focus/highlight
- Bottom console accepts NL instructions and shows logs
- On-map tool strip exposes Select, Mine Area, Build Warrior, Cancel
- Left-drag rectangle creates an area; text prompt appears; task created on submit
- Clicking a WarriorSpot with enough iron places a stationary melee warrior
- All critical gameplay can be performed with the mouse alone


